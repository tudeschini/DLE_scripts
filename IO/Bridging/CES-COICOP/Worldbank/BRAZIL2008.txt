**
*** Generate commodity-level file  
**
*Food consumption
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==63
# delimit ;
recode COD_ITEM 
	(101=4)(102=4)(103=4)(104=4)(105=4)(106=4)(107=4)(108=4)(109=4)(110=4)(111=4)(112=4)	
	(113=4)(114=4)(115=4)(201=4)(202=4)(203=4)(204=4)(301=4)(401=5)(402=4)(403=4)(501=4)	
	(601=5)(701=5)(702=5)(703=5)(704=5)(705=5)(706=5)(707=5)(708=5)(709=5)(710=5)(711=5)	
	(712=5)(713=5)(714=5)(801=5)(901=5)(902=5)(903=5)(904=5)(905=5)
	(1001=5)(1002=5)(1003=5)(1004=5)(1005=5)(1006=5)(1101=5)(1201=5)(1202=5)(1203=5)	
	(1204=5)(1205=30)(1301=30)(1302=30)(1303=30)(1304=30)(1305=30)(1306=30)(1307=30)(1308=30)	
	(1309=30)(1310=30)(1311=30)(1401=30)(1402=30)(1403=30)(1404=30)(1405=30)(1406=30)(1407=30)	
	(1408=30)(1409=30)(1410=30)(1411=30)(1412=30)(1501=30)(1502=30)(1503=30)(1504=30)(1505=30)	
	(1506=30)(1507=30)(1508=30)(1509=30)(1510=30)(1511=30)(1512=30)(1513=30)(1601=30)(1602=30)	
	(1603=30)(1604=30)(1605=30)(1606=30)(1607=30)(1608=30)(1609=30)(1610=30)(1611=30)(1612=30)	
	(1613=30)(1614=30)(1615=30)(1616=30)(1617=30)(1618=30)(1619=30)(1620=30)(1621=30)(1622=30)	
	(1623=30)(1624=30)(1625=30)(1626=30)(1627=30)(1628=30)(1629=30)(1630=30)(1631=30)(1632=30)	
	(1633=30)(1634=30)(1635=30)(1636=30)(1701=30)(1702=30)(1703=30)(1704=30)(1705=30)(1706=30)	
	(1707=30)(1801=4)(1802=4)(1901=30)(1902=30)(1903=30)(1904=30)(1905=30)(1906=30)(1907=30)	
	(1908=30)(1909=30)(1910=30)(1911=30)(2001=4)(2101=30)(2102=30)(2103=30)(2104=30)(2105=30)	
	(2106=30)(2107=30)(2108=30)(2109=30)(2110=30)(2111=30)(2112=30)(2113=30)(2114=30)(2115=30)	
	(2116=30)(2201=30)(2202=30)(2203=30)(2204=30)(2205=30)(2206=30)(2207=30)(2301=30)(2302=30)	
	(2303=30)(2304=30)(2305=30)(2401=30)(2402=30)(2501=30)(2502=30)(2503=30)(2504=30)(2505=30)	
	(2506=30)(2507=30)(2508=30)(2509=30)(2510=30)(2511=30)(2512=30)(2601=30)(2602=30)(2603=30)	
	(2604=30)(2605=30)(2606=30)(2607=30)(2608=30)(2609=30)(2701=30)(2702=30)(2703=30)(2801=30)	
	(2901=32)(3001=5)(3002=30)(3101=30)(3102=30)(3201=5)(3301=4)(3302=4)(3303=4)(3304=4)	
	(3305=4)(3401=4)(3402=4)(3501=30)(3502=30)(3601=30)(3701=30)(3702=30)(3801=30)(3802=30)	
	(3803=30)(3804=30)(3805=30)(3806=30)(3807=30)(3808=30)(3809=30)(3810=30)(3811=30)(3812=30)	
	(3901=30)(3902=30)(3903=30)(3904=30)(3905=30)(3906=30)(3907=30)(3908=30)(3909=30)(3910=30)	
	(3911=30)(3912=30)(3913=30)(4001=30)(4002=30)(4003=30)(4004=30)(4005=30)(4006=30)(4007=30)	
	(4008=30)(4009=30)(4010=30)(4011=30)(4012=30)(4013=30)(4014=30)(4015=30)(4016=30)(4017=30)	
	(4018=30)(4019=30)(4020=30)(4021=30)(4022=30)(4023=30)(4024=30)(4025=30)(4026=30)(4027=30)	
	(4028=30)(4029=30)(4030=30)(4031=30)(4032=30)(4033=30)(4034=30)(4035=30)(4101=30)(4102=30)	
	(4201=30)(4202=30)(4301=4)(4302=4)(4303=4)(4304=4)(4305=4)(4306=4)(4307=4)(4308=4)	
	(4309=4)(4310=4)(4311=4)(4312=4)(4313=4)(4314=4)(4315=4)(4401=4)(4402=4)(4403=4)	
	(4404=4)(4501=4)(4601=30)(4701=5)(4801=5)(4901=5), gen (icp_seq);
# delimit cr

tempfile code63
save `code63', replace


use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==64
# delimit ;
recode COD_ITEM 
	(101=31)(102=31)(103=31)(104=31)(105=31)(106=31)(107=31)(108=31)(109=31)(110=31)(201=30)(202=30)	
	(301=31)(302=31)(303=31)(304=31)(305=30)(401=31)(402=31)(403=31)(404=31)(405=31)(406=31)(501=30)	
	(502=30)(503=30)(504=30)(505=30)(506=30)(507=30)(508=30)(509=30)(510=30)(601=30)(602=30)(603=30)	
	(604=30)(605=30)(606=30)(607=30)(608=30)(609=30)(610=30)(611=30)(612=30)(613=30)(614=30)(701=30)	
	(702=30)(703=30)(704=30)(705=30)(706=30)(707=30)(708=30)(709=30)(710=30)(711=31)(712=30)(713=30)	
	(714=30)(715=30)(716=31)(717=31)(718=30)(801=31)(802=31)(901=31)(902=31)(903=31)(904=31)(905=31)	
	(906=31)(907=31)(908=30)(1001=30)(1002=30)(1101=30)(1201=30)(1202=30)(1203=30)(1301=30)(1302=30)(1303=30)	
	(1401=30)(1402=30)(1403=30)(1501=30)(1502=30)(1601=30)(1701=30)(1801=31)(1802=31)(1803=31)(1804=31)(1805=31)	
	(1806=31)(1807=31)(1808=31)(1809=31)(1901=30)(1902=30)(1903=30)(2001=30), gen (icp_seq);
# delimit cr

tempfile code64
save `code64', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==65
# delimit ;
recode COD_ITEM 
	(101=4)(102=4)(103=4)(104=4)(105=5)(106=4)(107=4)(108=4)(109=4)(201=4)(202=4)(203=4)	
	(204=4)(301=5)(401=5)(402=5)(403=5)(404=5)(501=5)(601=5)(602=5)(603=5)(604=5)(605=5)	
	(606=5)(607=5)(608=5)(609=5)(610=5)(611=5)(612=5)(613=5)(614=5)(615=5)(616=5)(617=5)	
	(618=5)(701=5)(702=5)(703=5)(704=5)(705=5)(706=5)(707=5)(801=5)(802=5)(803=5)(804=5)	
	(805=5)(901=5)(902=5)(903=5)(904=5)	
	(1001=5)(1002=5)(1003=5)(1004=5)(1005=5)(1006=5)(1101=5)(1201=5)(1202=5)(1203=5)(1204=5)(1205=5)	
	(1301=5)(1302=5)(1303=5)(1304=5)(1401=5)(1402=5)(1403=5)(1404=5)(1405=5)(1406=5)(1407=5)(1408=5)	
	(1409=5)(1410=5)(1411=5)(1412=5)(1413=5)(1414=5)(1415=5)(1416=5)(1417=5)(1418=5)(1419=5)(1501=5)	
	(1502=5)(1503=5)(1504=5)(1505=5)(1506=5)(1507=5)(1508=5)(1509=5)(1510=5)(1511=5)(1512=5)(1513=5)	
	(1514=5)(1515=5)(1516=5)(1517=5)(1518=5)(1519=5)(1601=5)(1701=5)(1801=5)(1802=5)(1901=5)(2001=5)	
	(2101=5)(2102=5)(2103=5)(2104=5)(2105=5)(2201=5)(2202=5)(2301=5)(2302=5)(2401=5)(2402=5)(2403=5)	
	(2404=5)(2501=5)(2601=5)(2602=5)(2603=5)(2604=5)(2605=5)(2701=5)(2702=5)(2703=5)(2801=5)(2802=5)	
	(2901=5)(2902=5)(2903=5)(2904=5)(2905=5)(3001=5)(3002=5)(3101=5)(3102=5)(3103=5)(3201=5)(3202=5)	
	(3203=5)(3204=5)(3205=5)(3206=5)(3207=5)(3208=5)(3209=5)(3210=5)(3211=5)(3212=5)(3213=5)(3214=5)	
	(3215=5)(3216=5)(3217=5)(3218=5)(3219=5)(3220=5)(3221=5)(3222=5)(3223=5)(3224=5)(3301=5)(3302=5)	
	(3303=5)(3304=5)(3305=5)(3306=5)(3307=5)(3308=5)(3309=5)(3310=5)(3311=8)(3312=8)(3313=8)(3314=8)	
	(3315=8)(3316=8)(3401=8)(3402=8)(3403=8)(3404=8)(3405=8)(3406=8)(3407=5)(3408=5)(3409=5)(3410=8)	
	(3411=8)(3412=8)(3413=8)(3414=8)(3415=5)(3416=5)(3417=5)(3501=31)(3601=5)(3602=5)(3603=5)(3604=8)	
	(3605=5)(3606=5)(3701=5)(3702=5)(3801=5)(3802=5)(3803=5)(3901=5)(4001=5)(4101=5)(4102=5)(4201=5)	
	(4202=5)(4203=5)(4301=5)(4302=5)(4401=5)(4402=5)(4501=5)(4502=5)(4503=5)(4504=5)(4505=5)(4601=5)	
	(4701=5)(4801=5)(4802=8)(4803=5)(4901=8)(5001=5)(5002=5)(5101=5)(5102=5)(5201=5)(5301=5)(5401=5)	
	(5501=5)(5601=5)(5602=5)(5603=5)(5701=5)(5702=5)(5801=5)(5901=5)(5902=5)(5903=5)(6001=5)(6002=5)	
	(6003=5)(6101=5)(6102=5)(6201=5)(6202=5)(6301=5)(6302=5)(6303=5)(6401=5)(6402=5)(6403=5)(6501=5)	
	(6601=5)(6701=5)(6801=5)(6901=5)(7001=5)(7101=5), gen (icp_seq);
# delimit cr

tempfile code65
save `code65', replace


use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==66
recode COD_ITEM  (101/2801=28), gen(icp_seq)
tempfile code66
save `code66', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==67
recode COD_ITEM  (101/10901=30), gen(icp_seq)
tempfile code67
save `code67', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==68
recode COD_ITEM  (101/10201=27), gen(icp_seq)
tempfile code68
save `code68', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==69
# delimit ;
recode COD_ITEM  (101/2302=36)(2401/2421=32)(2501/6301=36)(6401/6421=32)(6501=36)(6502=36)
(6601/7106=34)(7201/7910=36)(8001/8006=28)(8101/8501=36)(8601/8903=34)(9001/9007=35)(9101=34)
(9201/9310=28)(9401/14801=36), gen(icp_seq);
# delimit cr
tempfile code69
save `code69', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==70
recode COD_ITEM (101/12601=37), gen(icp_seq)
tempfile code70
save `code70', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==71
# delimit ;
recode COD_ITEM (101/3301=10)(3302/5302=11)(5401/6201=12)(6301/6709=14)(6801=11)(6802=11)(6901=10)
	(6902=10)(7001=11)(7002=11)(7101=11)(7102=10)(7103/7502=12)(7601/7806=14)(7901 7902=10)(8001=14)
	(8101/8107=12)(8201/8502=11)(8601=10)(8701=12)(8702=12)(8703=12)(8801=10)(8901=14)(8902=10)(9001=10)	
	(9101=10)(9201=10)(9301=12)(9401=12)(9501=10)(9601=10)(9701=11)(9801=12)(9802=12)(9901=12)(10001=14)	
	(10101=14)(10201=10)(10301=12)(10401=12)(10501=11)(10502=11)(10601=10)(10701=14)(10702=14)(10801=14)(10901=14)	
	(10902=14)(11001=14)(11101=14)(11201=14)(11202=14)(11301=10)(11302=10)(11303=10)(11304=10)(11401=10)(11402=10)	
	(11403=11)(11404=11)(11405=10)(11406=10)(11407=10)(11501=10)(11502=10)(11503=10)(11504=10)(11505=10)(11506=10)	
	(11507=10)(11508=10)(11509=10)(11601=10)(11602=10)(11603=10)(11701=10)(11702=10)(11703=10)(11704=10)(11801=10)	
	(11802=10)(11803=10)(11804=10)(11805=14)(11806=14)(11807=14)(11808=14)(11901=14)(11902=14)(11903=14)(11904=14)	
	(11905=14)(11906=14)(11907=14)(12001=14)(12002=14)(12101=14)(12201=14)(12301=14)(12401=14), gen(icp_seq);
# delimit cr
tempfile code71
save `code71', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==72
recode COD_ITEM (101/81101=16), gen(icp_seq)
tempfile code72
save `code72', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==74
recode COD_ITEM (101/61102=16), gen(icp_seq)
tempfile code74
save `code74', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==76
recode COD_ITEM (101/901=16), gen(icp_seq)
tempfile code76
save `code76', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==77
# delimit ;
recode COD_ITEM 
	(101=28)(102=28)(103=28)(104=28)(105=28)(106=28)(107=28)(201=28)(202=28)(301=28)(302=28)(401=28)	
	(402=28)(501=28)(601=28)(602=28)(603=28)(701=28)(801=28)(901=28)(902=28)(1001=28)(1002=28)(1101=28)	
	(1102=28)(1201=28)(1202=28)(1203=37)(1204=37)(1205=37)(1206=37)(1207=28)(1208=37)(1301=28)(1401=28)(1402=28)	
	(1403=28)(1404=28)(1405=28)(1406=28)(1407=28)(1408=28)(1409=28)(1501=28)(1502=28)(1503=28)(1504=28)(1505=28)	
	(1601=28)(1602=28)(1701=28)(1702=28)(1801=28)(1802=28)(1803=28)(1901=28)(1902=28)(1903=28)(2001=28)(2002=28)	
	(2101=28)(2201=14)(2202=14)(2301=14)(2302=14)(2303=14)(2401=14)(2402=14)(2501=14)(2502=14)(2503=14)(2601=14)	
	(2602=14)(2603=14)(2604=14)(2605=14)(2606=14)(2607=14)(2701=14)(2702=14)(2703=14)(2704=14)(2705=14)(2706=14)	
	(2707=14)(2708=14)(2801=14)(2901=14)(3001=17)(3002=17)(3003=17)(3101=17)(3102=17)(3103=17)(3104=17)(3201=17)	
	(3202=17)(3301=17)(3302=17)(3401=17)(3402=17)(3403=17)(3404=17)(3501=17)(3502=17)(3601=17)(3701=28)(3801=28)	
	(3901=17)(3902=17)(4001=17)(4101=17)(4102=17)(4201=28)(4301=28)(4401=28)(4402=28)(4501=17)(4502=17)(4601=14)	
	(4602=14)(4603=14)(4604=14)(4701=14)(4702=14)(4801=14)(4802=14)(4901=17)(4902=14)(4903=14)(4904=14)(5001=14)	
	(5101=14)(5102=14)(5201=14)(5301=14)(5401=14)(5402=14)(5403=14)(5501=37)(5601=37)(5701=37)(5702=37)(5703=37)	
	(5801=37)(5802=37)(5901=37)(6001=17)(6101=37)(6102=37)(6103=37)(6104=28)(6105=28)(6106=28)(6107=28)(6201=17)	
	(6202=17)(6203=17)(6301=17)(6302=17)(6303=17)(6304=17)(6401=14)(6501=14)(6502=14)(6601=14)(6701=14)(6801=14)	
	(6901=22)(7001=28)(7101=28)(7102=28)(7201=28)(7301=28)(7401=28)(7501=28)(7601=28), gen(icp_seq);
# delimit cr
tempfile code77
save `code77', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==78
# delimit ;
recode COD_ITEM 
	(101=13)(102=13)(103=13)(104=13)(201=13)(202=13)(203=13)(204=13)(205=13)(206=13)(207=13)	
	(208=13)(209=13)(301=13)(302=13)(303=13)(304=13)(305=13)(306=13)(307=13)(401=13)(402=13)	
	(403=13)(404=13)(405=13)(406=13)(501=13)(502=13)(503=13)(504=13)(505=13)(506=13)(601=13)	
	(602=13)(603=13)(604=13)(701=13)(702=13)(703=13)(704=13)(705=13)(706=13)(707=13)(708=13)	
	(709=13)(801=13)(802=13)(901=13)(902=13)(1001=13)(1002=13)(1101=13)(1102=13)(1201=13)(1202=13)	
	(1301=13)(1302=13)(1401=13)(1402=13)(1403=13)(1404=13)(1501=13)(1601=13)(1602=13)(1603=13)(1701=13)	
	(1702=13)(1703=13)(1801=13)(1802=13)(1901=13)(1902=13)(2001=13)(2002=13)(2101=13)(2201=13)(2202=13)	
	(2301=13)(2401=13)(2501=13)(2502=13)(2601=13)(2602=13)(2701=13)(2702=13)(2801=13)(2802=13)(2803=13)	
	(2804=13)(2901=13)(2902=13)(2903=13)(2904=13)(3001=13)(3002=13)(3003=13)(3101=13)(3201=13)(3202=13)	
	(3301=22)(3302=22)(3303=22)(3304=22)(3305=22)(3401=22)(3501=13)(3601=13)(3602=13)(3701=13)(3702=13)	
	(3703=13)(3704=13)(3705=13)(3706=13)(3707=13)(3708=13)(3709=13)(3710=13)(3711=13)(3712=13)(3713=13)	
	(3714=13)(3715=13)(3716=13)(3717=13)(3718=13)(3719=13)(3720=13)(3721=13)(3722=13)(3723=13)(3724=13)	
	(3725=13)(3726=13)(3727=13)(3728=13)(3729=13)(3801=13)(3901=13)(3902=13)(3903=13)(3904=13)(3905=13)	
	(3906=13)(3907=13)(3908=13)(3909=13)(3910=13)(3911=13)(3912=13)(3913=13)(4001=13)(4101=13)(4201=13)	
	(4301=22)(4401=22)(4501=22)(4601=13)(4701=13)(4801=13)(4901=13)(5001=13)(5101=13)(5201=13)(5301=13)	
	(5401=13)(5501=13)(5502=13)(5503=13)(5504=13)(5601=13)(5602=13)(5603=13)(5604=13)(5605=13)(5606=13)	
	(5607=13)(5608=13)(5701=13)(5702=13)(5703=13)(5704=13)(5801=13)(5802=13)(5803=13)(5804=13)(5805=13)	
	(5806=13)(5901=13)(5902=13)(5903=13)(5904=13)(5905=13)(6001=13)(6002=13)(6101=13)(6201=13)(6301=22)	
	(6401=13)(6501=22)(6601=13)(6701=22)(6801=13)(6901=13), gen(icp_seq);
# delimit cr
tempfile code78
save `code78', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==79
# delimit ;
recode COD_ITEM 
	(101=20)(102=20)(103=20)(104=20)(105=20)(106=20)(107=20)(108=20)(109=20)(110=20)(111=20)(112=20)	
	(201=20)(202=20)(203=20)(204=19)(205=19)(301=20)(401=20)(501=20)(601=20)(602=20)(603=20)(604=20)	
	(605=20)(606=20)(607=20)(608=20)(701=20)(702=20)(703=20)(704=20)(705=20)(706=20)(707=20)(708=20)	
	(709=20)(710=20)(801=20)(901=20)(902=20)(903=20)(904=20)(1001=20)(1101=20)(1102=20)(1201=20)(1202=20)	
	(1203=20)(1204=20)(1205=20)(1206=20)(1207=20)(1208=20)(1209=20)(1210=20)(1211=20)(1212=20)(1301=20)(1302=20)	
	(1303=20)(1304=20)(1305=20)(1306=20)(1307=20)(1308=20)(1309=20)(1401=20)(1402=20)(1403=20)(1404=20)(1405=20)	
	(1501=24)(1502=24)(1503=24)(1504=24)(1505=24)(1506=24)(1507=24)(1508=24)(1509=24)(1601=24)(1602=24)(1603=24)	
	(1604=24)(1605=24)(1606=24)(1607=24)(1608=24)(1609=24)(1701=21)(1702=21)(1703=21)(1704=21)(1705=21)(1706=21)	
	(1801=21)(1802=21)(1803=21)(1804=21)(1805=21)(1806=21)(1807=21)(1808=21)(1809=21)(1901=21)(1902=21)(1903=21)	
	(2001=21)(2002=21)(2003=21)(2004=21)(2005=21)(2006=21)(2007=21)(2008=21)(2009=21)(2010=21)(2011=21)(2012=21)	
	(2013=21)(2101=21)(2102=21)(2103=21)(2104=21)(2105=21)(2106=21)(2107=21)(2108=21)(2109=21)(2110=21)(2111=21)	
	(2201=21)(2301=21)(2302=21)(2303=21)(2304=5)(2305=5)(2306=5)(2307=5)(2308=5)(2309=5)(2310=5)(2401=21)	
	(2402=21)(2403=21)(2404=21)(2405=21)(2501=21)(2601=21)(2602=21)(2701=21)(2801=21)(2802=21)(2803=21)(2804=21)	
	(2805=21)(2806=21)(2901=21)(2902=21)(2903=21)(2904=21)(2905=21)(2906=21)(2907=21)(2908=21)(2909=21)(3001=21)	
	(3101=20)(3102=20)(3103=20)(3104=20)(3105=20)(3106=20)(3107=20)(3108=20)(3109=20)(3110=20)(3111=20)(3112=20)	
	(3113=20)(3201=20)(3202=20)(3203=20)(3204=20)(3301=20)(3401=20)(3402=20)(3403=20)(3404=20)(3501=20)(3502=20)	
	(3601=20)(3602=20)(3603=20)(3604=20)(3605=20)(3701=20)(3702=20)(3703=20)(3801=20)(3802=20)(3803=20)(3901=20)	
	(3902=20)(3903=20)(3904=20)(3905=20)(3906=20)(3907=20)(4001=20)(4002=20)(4003=20)(4004=20)(4005=20)(4006=20)	
	(4007=20)(4008=20)(4101=24)(4102=24)(4103=24)(4104=24)(4105=24)(4106=24)(4107=24)(4108=24)(4109=24)(4110=24)	
	(4111=24)(4112=24)(4113=24)(4114=24)(4115=24)(4116=24)(4201=24)(4202=24)(4203=24)(4204=24)(4205=24)(4206=24)	
	(4207=24)(4208=24)(4301=20)(4302=20)(4303=20)(4304=20)(4305=20)(4306=20)(4307=20)(4308=20)(4309=20)(4310=20)	
	(4311=20)(4401=20)(4402=20)(4403=20)(4501=20)(4502=20)(4503=20)(4601=20)(4602=20)(4603=20)(4701=20)(4801=20)	
	(4802=20)(4803=20)(4804=20)(4805=20)(4901=20)(5001=20)(5002=20)(5101=21)(5102=21)(5103=21)(5104=21)(5105=21)	
	(5106=21)(5107=21)(5201=5)(5202=20)(5203=20)(5301=20)(5401=20)(5402=20)(5403=20)(5404=20)(5501=20)(5502=20)	
	(5503=20)(5504=20)(5505=20)(5506=20)(5507=20)(5508=20)(5601=20)(5701=20)(5702=20)(5801=20)(5802=20)(5803=20)	
	(5804=20)(5901=21)(5902=21)(5903=21)(6001=21)(6002=21)(6003=21)(6004=21)(6005=21)(6006=21)(6007=21)(6008=21)	
	(6009=21)(6010=21)(6011=21)(6101=21)(6102=21)(6103=21)(6104=21)(6105=21)(6106=21)(6107=21)(6108=21)(6109=21)	
	(6201=21)(6301=21)(6302=21)(6303=21)(6304=21)(6305=21)(6401=21)(6402=21)(6403=21)(6404=21)(6405=21)(6501=21)	
	(6502=21)(6503=21)(6504=21)(6505=21)(6506=21)(6507=21)(6508=21)(6601=21)(6701=20)(6702=20)(6703=20)(6704=20)	
	(6705=20)(6706=20)(6707=20)(6708=20)(6709=20)(6710=20)(6801=20)(6802=20)(6803=20)(6804=20)(6805=20)(6806=20)	
	(6807=20)(6808=20)(6809=20)(6810=20)(6811=20)(6812=20)(6813=20)(6814=20)(6815=20)(6816=20)(6817=20)(6818=20)	
	(6819=20)(6820=20)(6901=20)(7001=20)(7101=24)(7102=24)(7103=24)(7104=24)(7105=24)(7106=24)(7201=20)(7301=21)	
	(7302=21)(7303=21)(7304=21)(7305=21)(7306=21)(7307=21)(7308=21)(7309=21)(7310=21)(7311=21)(7401=20)(7501=20)	
	(7502=20)(7601=20)(7701=20)(7801=21)(7802=21)(7803=21)(7901=21)(8001=21)(8101=21)(8201=21)(8301=21)(8401=21)	
	(8501=21)(8601=20)(8602=20)(8701=6), gen(icp_seq);
# delimit cr
tempfile code79
save `code79', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==80
# delimit ;
recode COD_ITEM 
(101/1802=6)(1901/6201=7)(6301/6804=6)(6901/8802=7)(8901/9402=6)(9501/9806=7)(9901/10036=6)	
(10037/11501=7),gen(icp_seq);
# delimit cr
tempfile code80
save `code80', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==81
recode COD_ITEM (101/6701=14),gen(icp_seq)
tempfile code81
save `code81', replace
 
use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==82
# delimit ;
recode COD_ITEM 
(101=40)(102=40)(103=40)(104=40)(105=40)(106=40)(107=40)(201=40)(202=40)(203=40)(204=40)(205=40)	
(206=40)(207=40)(208=40)(209=40)(210=40)(301=40)(302=40)(303=40)(304=40)(305=40)(306=40)(307=40)	
(401=40)(402=40)(403=40)(404=40)(405=40)(406=40)(407=40)(408=40)(409=40)(410=40)(501=40)(502=40)	
(503=40)(504=40)(505=40)(506=40)(601=40)(602=40)(701=40)(702=40)(703=40)(801=40)(802=40)(803=40)	
(804=40)(805=40)(806=40)(807=40)(808=40)(809=40)(810=40)(901=40)(902=40)(1001=40)(1002=40)(1003=40)	
(1004=40)(1005=40)(1006=40)(1007=40)(1008=40)(1009=40)(1010=40)(1011=40)(1012=40)(1013=40)(1014=40)(1015=40)	
(1016=40)(1101=40)(1102=40)(1103=40)(1104=40)(1105=40)(1106=40)(1107=40)(1201=40)(1202=40)(1301=40)(1302=40)	
(1401=40)(1402=40)(1501=40)(1502=40)(1503=40)(1504=40)(1505=40)(1506=40)(1507=40)(1508=40)(1509=40)(1510=40)	
(1601=40)(1602=40)(1603=40)(1604=40)(1701=40)(1702=40)(1801=40)(1802=40)(1901=40)(1902=40)(2001=40)(2002=40)	
(2101=40)(2201=40)(2202=40)(2203=40)(2204=40)(2301=40)(2302=40)(2401=40)(2402=40)(2403=40)(2404=40)(2405=40)	
(2406=40)(2407=40)(2408=40)(2409=40)(2410=40)(2411=40)(2412=40)(2501=40)(2502=39)(2503=39)(2601=39)(2602=39)	
(2701=39)(2702=39)(2703=39)(2801=39)(2802=39)(2803=39)(2804=39)(2805=39)(2901=39)(2902=39)(2903=39)(2904=39)	
(3001=39)(3002=39)(3101=39)(3102=39)(3201=39)(3202=39)(3301=39)(3302=39)(3303=39)(3401=39)(3402=39)(3501=39)	
(3601=39)(3602=39)(3603=39)(3604=39)(3701=39)(3801=39)(3802=39)(3901=39)(4001=39)(4002=39)(4003=39)(4101=39)	
(4102=39)(4103=39)(4104=39)(4201=39)(4202=39)(4301=39)(4302=39)(4401=39)(4402=39)(4501=39)(4502=39)(4503=39)	
(4504=39)(4601=40)(4602=40)(4603=40)(4701=40)(4702=40)(4703=40)(4704=40)(4801=40)(4802=40)(4803=40)(4901=40)	
(4902=40)(4903=40)(5001=40)(5101=40)(5102=40)(5201=39)(5202=39)(5203=39)(5204=39)(5205=39)(5206=39)(5207=39)	
(5208=39)(5301=40)(5302=40)(5401=40)(5402=40)(5501=40)(5502=40)(5601=40)(5602=40)(5701=40)(5702=40)(5801=40)	
(5802=40)(5803=40)(5804=40)(5805=40)(5806=40)(5901=40)(6001=40)(6101=39)(6102=39)(6201=40)(6301=39)(6401=39)	
(6402=39)(6501=39)(6502=39)(6503=39)(6504=39)(6601=39)(6602=39)(6701=40)(6702=40)(6801=40)(6901=40)(7001=40)	
(7101=40)(7201=40)(7301=40)(7401=40)(7402=40)(7403=40)(7404=40)(7405=40)(7406=40)(7501=40)(7502=40)(7503=40)	
(7504=40)(7505=40)(7506=40)(7507=40)(7508=40)(7601=40)(7602=40)(7603=40)(7604=40)(7605=40)(7606=40)(7701=40)	
(7702=40)(7703=40)(7704=40)(7705=40)(7801=40)(7802=40)(7901=40)(7902=40)(8001=40)(8002=40)(8003=40)(8101=40)	
(8102=40)(8103=40)(8104=40)(8105=40)(8106=40)(8201=40)(8202=40)(8301=40)(8302=40)(8401=40)(8402=40)(8501=40)	
(8502=40)(8601=40)(8701=40)(8702=40)(8801=40)(8802=40)(8901=40)(8902=40)(8903=40)(9001=40)(9002=40)(9003=40)	
(9101=40)(9102=40)(9201=40)(9202=40)(9301=40)(9302=40)(9401=40)(9402=40)(9501=40)(9601=40)(9701=40)(9801=40)	
(9901=40)(10001=40)(10101=40)(10102=40)(10201=40)(10202=40)(10203=40)(10204=40)(10301=40)(10302=40)(10401=40)(10402=40)	
(10501=40)(10601=39)(10602=39)(10701=39)(10702=39)(10801=39)(10901=39)(11001=40)(11002=40)(11003=40)(11004=40)(11005=40)	
(11006=40)(11007=40)(11101=40)(11102=40)(11103=40)(11104=40)(11105=40)(11106=40)(11107=40)(11108=40)(11109=40)(11110=40)	
(11111=40)(11112=40)(11113=40)(11114=40)(11201=39)(11202=39)(11203=39)(11301=39)(11302=39)(11303=39)(11304=39)(11305=39)	
(11306=39)(11401=40)(11402=40)(11501=40)(11502=40)(11503=40)(11504=40)(11601=40)(11602=40)(11603=40)(11604=40)(11701=40)	
(11702=40)(11703=40)(11704=40)(11705=40)(11706=40)(11707=40)(11708=40)(11801=40)(11802=40)(11901=40)(11902=40)(11903=40)	
(11904=40)(12001=40)(12002=40)(12101=40)(12102=40)(12103=40)(12104=40)(12201=40)(12301=40)(12302=40)(12401=39)(12402=39)	
(12501=39)(12502=39)(12503=39)(12504=39)(12601=39)(12602=39)(12603=39)(12701=39)(12702=39)(12703=39)(12801=39)(12802=39)	
(12803=39)(12804=39)(12805=39)(12806=39)(12901=39)(12902=40)(12903=40)(12904=40)(12905=40)(12906=40)(13001=39)(13002=39)	
(13003=39)(13004=39)(13101=39)(13201=39)(13301=39)(13401=40)(13402=40)(13403=40)(13501=39)(13601=39)(13701=39)(13801=40)	
(13901=40)(14001=40)(14101=40)(14201=39)(14301=40)(14401=40)(14501=40)(14601=40)(14602=40)(14701=40)(14801=39)(14901=39)	
(15001=40)(15101=39)(15201=40)(15301=40)(15401=40)(15501=40)(15601=40), gen(icp_seq);
# delimit cr
tempfile code82
save `code82', replace
 

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==83
# delimit ;
recode COD_ITEM 
(101=45)(102=45)(103=45)(201=45)(202=45)(203=45)(204=45)(301=43)(302=43)(303=43)(304=43)(305=43)	
(401=43)(402=43)(403=43)(501=43)(502=43)(503=43)(601=43)(701=43)(801=43)(901=43)(902=43)(1001=43)	
(1002=43)(1101=43)(1201=43)(1202=43)(1301=43)(1401=43)(1501=43)(1601=43)(1701=43)(1801=43)(1901=43)(2001=43)	
(2101=43)(2201=43)(2301=43)(2302=43)(2401=44)(2402=44)(2403=44)(2404=44)(2405=44)(2406=44)(2407=44)(2408=44)	
(2409=44)(2410=44)(2411=44)(2412=44)(2413=44)(2414=44)(2415=44)(2416=44)(2417=44)(2501=43)(2601=43)(2701=43)	
(2801=43)(2901=43)(3001=43)(3101=43)(3201=43)(3301=45)(3401=43)(3501=44)(3601=44)(3602=44)(3603=44)(3604=44)	
(3605=44)(3606=44)(3607=44)(3608=44)(3609=44)(3610=44)(3611=44)(3612=44)(3613=44)(3614=44)(3615=44)(3616=43)	
(3617=43)(3701=43)(3702=43)(3703=43)(3704=43)(3801=43)(3802=43)(3803=43)(3901=43)(3902=43)(4001=43)(4101=43)	
(4201=43)(4301=45)(4302=45)(4303=45)(4401=45)(4501=43)(4502=43)(4601=43)(4701=43), gen(icp_seq);
# delimit cr
tempfile code83
save `code83', replace
 

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==84
recode COD_ITEM (101/4301=25), gen(icp_seq)
tempfile code84
save `code84', replace
 

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if PROD_NUM_QUADRO_GRUPO_PRO==85
# delimit ;
recode COD_ITEM 
(101=37)(102=37)(103=37)(104=37)(105=37)(106=37)(107=37)(108=37)(109=37)(201=37)(202=37)(203=37)	
(204=14)(205=37)(206=37)(207=37)(208=37)(209=37)(210=37)(211=37)(212=37)(213=37)(214=37)(215=37)	
(216=37)(217=37)(218=37)(219=14)(220=14)(221=14)(222=14)(223=14)(224=20)(225=20)(226=20)(227=37)	
(228=37)(229=37)(230=37)(231=37)(232=37)(301=37)(302=37)(303=14)(304=14)(305=22)(306=37)(307=37)	
(308=37)(309=37)(310=37)(311=37)(312=37)(313=37)(314=37)(315=37)(316=37)(317=37)(318=37)(319=37)	
(320=37)(321=37)(322=37)(323=37)(324=37)(325=37)(326=37)(327=37)(401=40)(402=40)(403=40)(404=40)	
(405=40)(406=40)(407=40)(408=40)(409=40)(410=40)(411=40)(412=40)(413=40)(414=40)(415=40)(416=40)	
(417=40)(418=40)(419=40)(501=37)(502=37)(503=37)(504=37)(505=37)(506=37)(507=37)(508=37)(509=37)	
(601=40)(602=40)(603=40)(604=40)(605=40)(606=40)(701=37)(702=37)(703=37)(704=37)(801=37)(802=37)	
(803=37)(804=37)(805=37)(806=37)(807=37)(901=37)(902=37)(903=37)(904=37)(905=37)(906=37)(907=37)	
(908=37)(909=37)(910=37)(911=37)(912=37)(913=37)(914=7)(915=7)(916=7)(917=7)(918=8)(919=8)(920=7)(1001=14)	
(1002=14)(1003=14)(1004=14)(1005=14)(1006=14)(1007=14)(1008=14)(1009=14)(1010=14)(1011=14)(1012=14)(1013=14)	
(1014=14)(1101=14)(1102=14)(1103=14)(1104=14)(1105=14)(1106=14)(1107=14)(1108=14)(1109=14)(1201=5)(1202=5)	
(1203=5)(1204=5)(1301=39)(1302=39)(1303=39)(1304=39)(1305=39)(1401=32)(1402=32)(1403=32)(1501=31)(1502=31)	
(1503=31)(1601=14)(1701=14)(1801=17)(1802=17)(1803=17)(1901=37)(1902=37)(1903=37)(1904=37)(1905=37)(2001=37)	
(2101=37)(2201=37)(2301=37)(2401=37)(2501=37)(2601=37)(2602=37)(2603=37)(2701=37)(2801=37)(2901=37)(3001=37)	
(3002=37)(3101=31)(3102=31)(3103=31)(3104=31)(3201=37)(3202=37)(3203=37)(3204=37)(3205=37)(3206=37)(3207=37)	
(3301=37)(3401=37)(3501=37)(3601=37)(3701=37)(3702=37)(3801=37)(3901=37)(4001=37)(4101=37)(4201=37)(4202=37)	
(4301=37)(4401=37)(4501=37)(4601=37)(4701=37)(4702=37)(4801=37)(4901=37)(5001=4)(5002=4)(5003=4)(5101=37)	
(5201=37)(5301=37)(5401=4)(5501=37)(5601=37)(5701=37)(5801=37)(5901=37)(6001=37)(6101=37)(6201=37)(6301=37)	
(6401=37)(6402=37)(6501=37)(6601=37)(6701=37)(6801=37)(6901=37)(7001=37)(7101=37)(7201=37)(7301=37)(7401=37)	
(7501=37)(7601=37)(7701=37)(7801=37)(7901=40)(7902=40)(7903=40)(7904=40)(7905=40)(7906=40)(7907=40)(7908=40)	
(7909=40)(7910=40)(7911=40)(7912=40)(7913=40)(7914=40)(7915=40)(7916=40)(7917=40)(7918=40)(8001=7)(8002=7)	
(8003=7)(8004=8)(8005=8)(8006=8)(8007=8)(8008=8)(8009=8)(8010=8)(8011=8)(8012=8)(8013=8)(8014=7)	
(8015=7)(8016=7)(8017=7)(8101=37)(8201=37)(8301=37)(8401=37)(8402=37)(8403=37)(8501=37)(8601=37)(8701=37)	
(8801=37)(8901=37)(9001=37)(9101=37)(9201=37)(9301=37)(9401=37)(9501=37)(9601=37)(9701=37)(9801=37), gen(icp_seq);


******************
**Non-Food Items**
******************

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==86
recode COD_ITEM (101/9501=81), gen(icp_seq)
tempfile code86
save `code86', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==87
recode COD_ITEM (101/1502=128), gen(icp_seq)
tempfile code87
save `code87', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==88
recode COD_ITEM (101/116=128), gen(icp_seq)
tempfile code88
save `code88', replace

use "$dirdata/t_caderneta_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==89
recode COD_ITEM (101/1502=141), gen(icp_seq)
tempfile code89
save `code89', replace

use "$dirdata/t_despesa_90dias_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==6
# delimit ;
recode COD_ITEM 
(101=60)(201=63)(301=64)(401=115)(501=116)(502=116)(503=116)(504=116)(505=116)(506=116)     
(701=130)(801=116)(901=116)(1001=130)(1101=116)(1201=116)(1202=116)(1203=116)(1204=116)(1301=116)     
(1401=116)(1501=116), gen(icp_seq);
# delimit cr
tempfile code6
save `code6', replace

use "$dirdata/t_despesa_90dias_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==7
# delimit ;
recode COD_ITEM 
(101=64)(102=64)(103=64)(104=64)(201=60)(202=60)(203=60)(204=60)(301=79)(401=60)(402=60)     
(403=60)(501=65)(502=65)(601=65)(602=65)(701=65)(702=65)(801=65)(802=65)(901=65)(902=65)
(1001=65)(1101=65), gen(icp_seq);
# delimit cr
tempfile code7
save `code7', replace

use "$dirdata/t_despesa_90dias_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==8
# delimit ;
recode COD_ITEM (101/7901=58), gen(icp_seq);
# delimit cr
tempfile code8
save `code8', replace

use "$dirdata/t_despesa_90dias_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==9
# delimit ;
recode COD_ITEM (101/401=70)(501/16201=75), gen(icp_seq);
# delimit cr
tempfile code9
save `code9', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==10
# delimit ;
recode COD_ITEM (101=57)(301=57)(401=57)(501/1401=151), gen(icp_seq);
# delimit cr
tempfile code10
save `code10', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==11
# delimit ;
recode COD_ITEM (101/8901=58), gen(icp_seq);
# delimit cr
tempfile code11
save `code11', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==12
# delimit ;
recode COD_ITEM (501 502 503 3501=147) (101 102 103=.), gen(icp_seq);
# delimit cr
tempfile code12
save `code12', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==13
# delimit ;
recode COD_ITEM 
(101=73)(201=115)(301=119)(401=119)(501=73)(601=73)(701=123)(801=73)(802=73)(901=73)(1001=119)     
(1101=119)(1201=119)(1301=119)(1401=119)(1501=119)(1601=119)(1701=119)(1801=73)(1901=74)(2001=74)     
(2101=74)(2201=74), gen(icp_seq);
# delimit cr
tempfile code13
save `code13', replace

*Durables
use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==15
# delimit ;
recode COD_ITEM 
(101=73)(102=73)(201=73)(301=73)(401=73)(501=73)(601=73)(602=73)(701=73)(801=74)(802=74)(803=74)     
(901=74)(1001=74)(1101=74)(1201=74)(1301=74)(1401=74)(1501=74)(1601=74)(1602=74)(1701=74)(1801=74)(1802=74)     
(1803=74)(1804=74)(1901=74)(2001=74)(2101=73)(2201=73)(2202=73)(2301=119)(2401=119)(2501=119)(2601=119)(2701=119)     
(2702=119)(2801=119)(2901=119)(2902=119)(2903=119)(3001=119)(3002=119)(3003=119)(3004=119)(3005=119)(3101=119)(3201=119)     
(3301=119)(3302=119)(3303=119)(3401=119)(3501=119)(3601=119)(3701=119)(3801=119)(3802=119)(3803=119)(3901=119)(4001=73)     
(4101=73)(4102=73)(4201=73)(4301=73)(4401=73)(4501=73)(4601=73)(4701=73)(4801=73)(4802=73)(4901=73)(4902=73)     
(4903=73)(5001=73)(5101=74)(5102=74)(5103=74)(5104=74)(5201=74)(5301=74)(5401=119)(5402=119)(5601=73)(5701=119)     
(5702=119)(5703=119)(5801=73)(5901=119)(5902=74)(6101=74)(6102=74)(6103=74)(6104=74)(6201=119)(6202=119)(6301=119)     
(6302=119)(6303=119)(6304=119)(6305=119)(6306=119)(6307=119)(6308=119)(6309=119)(6310=119)(6311=119)(6312=119)(6313=119)     
(6314=119)(6315=119)(6316=119)(6317=119)(6318=119)(6501=74)(6502=74)(6601=74)(6701=115)(6702=115)(6801=74)(6901=74)     
(6902=74)(7101=74)(7201=119)(7202=119)(7203=119)(7301=73)(7401=115)(7402=115)(7403=115)(7501=74)(7601=74)(7701=119)     
(7702=119)(7703=119)(7704=119)(7705=119)(7801=119)(7802=119)(7803=119)(7804=119)(7901=73)(8001=73)(8201=119)(8301=74)     
(8401=73)(8501=73)(8601=74)(8701=74)(8702=74)(8801=74)(8901=74)(9001=74)(9002=74)(9101=119)(9201=74)(9301=119)     
(9401=119)(9402=119)(9501=119)(9601=73)(9701=73)(9702=73)(9801=74)(9802=74)(9803=74)(9901=74)(10001=78)(10101=119)     
(10201=76)(10301=74)(10401=74)(10501=73)(10601=119)(10602=119)(10603=119)(10604=119)(10605=119)(10701=75)(10801=75)(10901=75)     
(10902=75)(11001=73)(11101=73)(11201=78)(11301=78)(11401=78)(11501=78)(11601=78)(11701=78)(11801=78)(11901=78)(12001=119)     
(12002=119)(12101=74)(12102=74)(12201=74)(12301=119)(12401=74)(12501=119)(12502=119)(12503=119)(12504=119)(12505=119)(12601=119)     
(12701=119)(12702=119)(12801=119)(12901=119)(12902=119)(12903=119)(13001=119)(13101=119)(13201=73)(13301=73)(13302=73)(13303=73)     
(13401=73)(13402=68)(13403=68)(13501=76)(13601=76)(13602=68)(13603=68)(13701=68)(13801=68)(13802=68)(13901=68)(14001=68)     
(14002=68)(14101=74)(14102=74)(14201=74)(14202=74)(14301=74)(14302=119)(14303=119)(14401=79)(14402=79)(14403=79)(14404=79)     
(14405=79)(14406=79)(14407=79)(14501=79)(14601=79)(14701=119)(14801=115)(14802=115)(14901=116)(15001=.)(15101=73)(15201=68)     
(15301=68)(15401=68)(15501=115)(15601=68)(15602=68)(15603=68)(15604=74)(15605=74)(15606=74)(15607=74)(15608=74)(15609=79)     
(15801=79)(15802=79)(15901=79)(16001=74)(16002=74)(16003=74)(16004=74)(16005=74)(16101=74)(16301=74)(16302=74)(16303=74)     
(16401=74)(16501=115)(16502=115)(16601=119)(16701=119)(16801=79)(16901=79)(16902=79)(17001=79)(17101=79)(17201=115)(17301=115)     
(17401=115)(17501=115)(17701=79)(17801=79)(17901=115)(18001=79)(18101=79)(18201=79)(18301=79)(18401=79)(18501=79)(18601=74)     
(18602=74)(18701=74)(18801=79)(18802=79)(18901=79)(19001=79)(19002=79)(19101=79)(19102=79)(19201=79)(19301=79)(19302=79)     
(19401=79)(19402=79)(19403=79)(19701=119)(20001=119)(20601=119)(20602=119)(20603=119)(20604=119)(20605=119)(20701=119)(20801=73)     
(20901=119)(21001=74)(21101=74)(21201=74)(21301=74)(21401=74)(21601=74)(21602=74), gen(icp_seq);
# delimit cr
tempfile code15
save `code15', replace


use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==16
# delimit ;
recode COD_ITEM 
(101=123)(201=123)(301=123)(401=123)(501=123)(601=123)(602=123)(701=123)(801=123)(901=123)(1001=123)(1101=123)     
(1201=123)(1301=123)(1401=123)(1501=123)(1601=79)(1602=79)(1603=79)(1604=79)(1605=79)(1606=79)(1607=79)(1608=79)     
(1609=79)(1610=79)(1611=79)(1612=79)(1613=79)(1614=79)(1615=79)(1616=79)(1617=79)(1618=79)(1619=79)(1620=79)     
(1621=79)(1622=79)(1623=79)(1624=79)(1625=79)(1626=79)(1627=79)(1628=79)(1629=79)(1630=79)(1631=79)(1632=79)     
(1633=79)(1634=79)(1635=79)(1636=79)(1637=79)(1638=79)(1639=79)(1640=79)(1641=79)(1642=79)(1643=79)(1644=79)     
(1645=79)(1646=79)(1647=79)(1648=79)(1649=79)(1650=79)(1652=79)(1653=79)(1654=79)(1655=79)(1656=79)(1657=79)     
(1658=79)(1659=79)(1660=79)(1661=79)(1701=79)(1801=127)(1802=127)(1901=127)(2001=126)(2002=126)(2003=126)(2004=126)     
(2005=126)(2006=126)(2101=126)(2201=126)(2301=126)(2302=126)(2401=128)(2402=128)(2403=128)(2404=128)(2405=128)(2406=128)     
(2407=128)(2501=128)(2502=128)(2503=128)(2504=128)(2505=128)(2506=128)(2601=128)(2701=128)(2801=123)(2901=123)(3001=123)     
(3101=123)(3201=123)(3301=123)(3401=123)(3601=123)(3701=123)(3801=123)(3901=128)(3902=128)(3903=128)(3904=128)(3905=128)     
(3906=128)(3907=128)(3908=128)(3909=128)(3910=128)(3911=128)(3912=128)(3913=128)(3914=128)(3915=128)(4001=123), gen(icp_seq);
# delimit cr

tempfile code16
save `code16', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==17
# delimit ;
recode COD_ITEM (101/9101=68), gen(icp_seq);
# delimit cr

tempfile code17
save `code17', replace

use "$dirdata/t_despesa_12meses_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==18
# delimit ;
recode COD_ITEM 
(101=69)(201=69)(301=69)(401=69)(501=69)(601=69)(602=69)(603=69)(604=69)(605=69)(701=79)(801=79)     
(901=79)(1001=79)(1002=79)(1003=79)(1004=79)(1101=79)(1102=79)(1201=79)(1202=79)(1301=79)(1302=79)(1401=79)     
(1501=79)(1502=79)(1503=79)(1504=79)(1505=79)(1506=79)(1601=79)(1701=79)(1801=79)(1802=79)(1803=79)(1804=79)     
(1901=69)(1902=69)(2001=69)(2101=69)(2201=69)(2202=69)(2301=69)(2401=69)(2402=69)(2403=69)(2501=69)(2502=69)     
(2601=69)(2602=69)(2701=69)(2801=69)(2802=69)(2803=69)(2901=69)(2902=69)(3001=69)(3002=69)(3101=69)(3201=69)     
(3202=69)(3203=69)(3204=69)(3301=69)(3302=69)(3401=69)(3501=69)(3601=69)(3701=69)(3801=69)(3802=69)(3901=69)     
(4001=69)(4002=69)(4101=69)(4102=69)(4201=69)(4301=69)(4302=69)(4401=69)(4501=69)(4601=69)(4602=69)(4603=69)     
(4604=69)(4701=69)(4801=69)(4901=69)(4902=69)(5001=69)(5101=69)(5102=69)(5103=69)(5104=69)(5201=69)(5301=69), gen(icp_seq);
# delimit cr

tempfile code18
save `code18', replace


use "$dirdata/t_servico_doms_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==19
# delimit ;
recode COD_ITEM (101/1602=83)(1701=52)(1801/53002=83), gen(icp_seq);
# delimit cr

tempfile code19
save `code19', replace


use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==22
# delimit ;
recode COD_ITEM 
(101=116)(102=116)(103=116)(104=116)(105=116)(106=116)(107=116)(108=116)(109=116)(110=116)(111=116)     
(112=116)(123=116)(201=116)(202=116)(203=116)(301=116)(401=116)(501=116)(502=116)(503=116), gen(icp_seq);
# delimit cr

tempfile code22
save `code22', replace


use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==23
# delimit ;
recode COD_ITEM 
(101=108)(201=107)(301=108)(302=108)(401=107)(501=110)(502=110)(503=110)(504=110)(505=110)(506=110)(507=110)     
(508=109)(509=110)(510=110)(601=103)(701=103)(801=105)(802=105)(803=105)(804=105)(901=105)(1001=105)(1101=105)     
(1201=100)(1301=103)(1401=105)(1501=105)(1502=105)(1601=111)(1701=103)(1801=103)(1901=105)(1902=105)(2001=108)(2101=108)     
(2201=109)(2301=110)(2302=110)(2303=108)(2304=108)(2305=108)(2306=108)(2307=108)(2308=108)(2309=108)(2501=.)(2601=108)     
(2602=108)(2801=103)(2802=103), gen(icp_seq);
# delimit cr

tempfile code23
save `code23', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==24
# delimit ;
recode COD_ITEM  (101/13901=136), gen(icp_seq);
# delimit cr
tempfile code24
save `code24', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==25
# delimit ;
recode COD_ITEM (101/1801=46), gen(icp_seq);
# delimit cr
tempfile code25
save `code25', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==26
# delimit ;
recode COD_ITEM (101/3001=132), gen(icp_seq);
# delimit cr
tempfile code26
save `code26', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==27
# delimit ;
recode COD_ITEM (101/2101=133), gen(icp_seq);
# delimit cr
tempfile code27
save `code27', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==28
# delimit ;
recode COD_ITEM (101=131)(201=131)(301/406=130)(501/5901=131), gen(icp_seq);
# delimit cr
tempfile code28
save `code28', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==29
# delimit ;
recode COD_ITEM (101/31401=87), gen(icp_seq);
# delimit cr
tempfile code29
save `code29', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==30
# delimit ;
recode COD_ITEM (101/3101=141), gen(icp_seq);
# delimit cr
tempfile code30
save `code30', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==31
# delimit ;
recode COD_ITEM (101/5301=140), gen(icp_seq);
# delimit cr
tempfile code31
save `code31', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==32
# delimit ;
recode COD_ITEM (201/1501=133), gen(icp_seq);
# delimit cr
tempfile code32
save `code32', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==33
# delimit ;
recode COD_ITEM (101/2607=123), gen(icp_seq);
# delimit cr
tempfile code33
save `code33', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==34
# delimit ;
recode COD_ITEM (101/107=50)(201=54)(202=54)(203=50)(204=50)(301=54)(401/3301=50), gen(icp_seq);
# delimit cr
tempfile code34
save `code34', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==35
# delimit ;
recode COD_ITEM 
(101=50)(102=50)(103=50)(104=50)(105=50)(106=50)(107=50)(108=50)(109=50)(110=50)(201=50)     
(202=50)(203=50)(301=50)(302=50)(303=50)(304=50)(305=50)(306=50)(307=50)(401=54)(501=50)     
(601=50)(602=50)(603=50)(604=50)(701=50)(702=50)(703=50)(704=50)(705=50)(706=50)(801=50)     
(802=50)(803=50)(901=50)(1001=50)(1002=50)(1101=50)(1102=50)(1103=50)(1201=50)(1202=50)(1301=50)     
(1401=51)(1501=50)(1601=50)(1602=50)(1603=50)(1604=50)(1701=50)(1801=50)(1901=50)(2001=50)(2101=50)     
(2102=50)(2201=50)(2301=50)(2401=50)(2501=51)(2601=50)(2701=54)(2801=50)(2901=50)(3001=50)(3101=50)     
(3201=50)(3202=50)(3301=50)(3401=50)(3501=50)(3601=50)(3701=50)(3702=50)(3703=50)(3801=50)(3802=50)     
(3901=54)(4001=50)(4101=54)(4201=50)(4202=50)(4301=50)(4401=54)(4501=50)(4601=50)(4701=50)(4801=54)     
(4901=54)(5001=50)(5101=54)(5201=50)(5301=50)(5401=50)(5501=50)(5601=50)(5701=50)(5801=54)(5901=50), gen(icp_seq);
# delimit cr
tempfile code35
save `code35', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==36
# delimit ;
recode COD_ITEM 
(101=50)(102=50)(103=50)(104=50)(105=50)(106=50)(201=54)(202=50)(203=50)(204=54)     
(301=50)(302=50)(303=50)(401=54)(501=50)(502=50)(503=50)(504=50)(505=50)(601=50)     
(701=50)(702=50)(703=50)(801=50)(802=50)(803=50)(804=50)(805=50)(806=50)(901=50)     
(902=50)(903=50)(904=50)(1001=50)(1101=50)(1201=50)(1301=50)(1302=50)(1401=50)(1402=54)     
(1501=50)(1502=50)(1503=50)(1504=50)(1601=50)(1701=51)(1702=51)(1801=50)(1802=54)(1803=50)     
(1804=50)(1805=50)(1806=50)(1807=54)(1808=50)(1809=50)(1810=50)(1811=54)(1812=50)(1813=50)     
(1814=50)(1901=50)(2001=50)(2101=50)(2201=50)(2301=50)(2401=50)(2402=50)(2403=50)(2404=50)     
(2501=50)(2601=50)(2701=50)(2801=50)(2802=50)(2803=50)(2804=50)(2901=50)(3001=54)(3101=50)     
(3201=50)(3301=50)(3401=54)(3501=54)(3601=50)(3602=50)(3701=54)(3801=50)(3901=50)(4001=50)     
(4101=50)(4102=50)(4201=50)(4301=50)(4401=50)(4501=50)(4601=50)(4701=50)(4801=54), gen(icp_seq);
# delimit cr
tempfile code36
save `code36', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==37
# delimit ;
recode COD_ITEM (101/4701=71), gen(icp_seq);
# delimit cr
tempfile code37
save `code37', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==38
# delimit ;
recode COD_ITEM 
(101=50)(102=50)(103=50)(104=50)(105=50)(201=50)(202=50)(203=50)(204=50)(301=50)(401=50)     
(501=50)(601=54)(701=54)(801=54)(901=54)(1001=54)(1002=54)(1003=54)(1101=54)(1102=54)(1103=54)     
(1201=54)(1202=54)(1203=54)(1301=54)(1302=54)(1303=54)(1401=54)(1402=54)(1403=54)(1501=54)(1601=54)     
(1701=54)(1801=54)(1901=54)(1902=54)(2001=54)(2101=50)(2201=50)(2301=50)(2302=50)(2303=50)(2304=54)     
(2401=54)(2501=54)(2601=54)(2701=54)(2801=54)(2901=50)(3001=54)(3002=54)(3003=54)(3101=50)(3201=54)     
(3202=54)(3203=54)(3301=54)(3401=54)(3501=50)(3601=50)(3701=50)(3702=50)(3801=50)(3901=50)(4001=54)     
(4002=50)(4101=54)(4201=54)(4301=54)(4401=50)(4501=50)(4601=54)(4701=54)(4801=54)(4901=54)(5001=50)     
(5101=50)(5102=50)(5201=50)(5202=50)(5301=50)(5401=50)(5501=50)(5601=50)(5701=50)(5702=50)(5801=50)     
(5901=50)(5902=50)(5903=50)(5904=50)(6001=50)(6002=50)(6003=50)(6101=50)(6201=50)(6301=54)(6401=54)     
(6501=54)(6601=54)(6701=50)(6801=50)(6901=50)(7001=50)(7101=50)(7201=50), gen(icp_seq);
# delimit cr
tempfile code38
save `code38', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==39
# delimit ;
recode COD_ITEM (101/9901=76), gen(icp_seq);
# delimit cr
tempfile code39
save `code39', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==40
# delimit ;
recode COD_ITEM 
(101=144)(102=144)(103=144)(104=144)(105=144)(106=144)(107=144)(201=127)(301=145)(302=145)     
(401=145)(501=112)(601=133)(701=130)(801=133)(802=133)(803=133)(804=133)(901=130)(1001=130)     
(1002=133)(1003=133)(1004=130)(1005=130)(1101=144)(1102=144)(1103=144)(1104=145)(1201=146)(1301=146)     
(1401=146)(1402=146)(1403=146)(1404=146)(1501=133)(1502=133)(1503=133)(1504=133)(1601=146)(1701=133)     
(1801=133)(1901=76)(2001=146)(2101=146)(2201=146)(2301=146)(2401=133)(2501=146)(2601=146), gen(icp_seq);
# delimit cr
tempfile code40
save `code40', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==41
# delimit ;
recode COD_ITEM 
(101=108)(201=107)(301=109)(401=110)(501=103)(601=137)(602=137)(603=137)(604=137)(605=137)(606=137)     
(607=137)(608=137)(609=137)(701=137)(702=137)(703=137)(704=137)(705=137)(706=137)(707=137)(708=137)     
(801=137)(901=137)(902=137)(1001=111)(1101=108)(1201=110)(1202=110)(1203=110)(1301=111)(1401=107)(1501=111)     
(1502=111)(1503=111)(1601=108)(1602=108)(1603=108)(1604=108)(1605=111)(1701=111)(1801=111)(1802=111)(1901=111)     
(2001=108)(2101=108)(2201=108)(2301=108)(2401=111)(2501=134)(2601=131)(2602=131)(2603=131)(2604=131)(2605=131)     
(2606=131)(2607=131)(2608=131)(2609=131)(2610=131)(2611=131)(3301=130)(3302=130)(3303=130)(3304=130)(3305=130)     
(3306=130)(3307=130)(3308=130)(3401=130)(3501=130)(3601=130)(3701=130)(3801=130)(3901=130)(4001=134)(4101=134)     
(4201=134), gen(icp_seq);
# delimit cr
tempfile code41
save `code41', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==42
# delimit ;
recode COD_ITEM 
(101=92)(102=92)(103=92)(104=92)(105=92)(201=93)(202=93)(203=93)(301=95)(401=94)(402=92)     
(403=92)(404=92)(405=92)(501=92)(502=92)(503=92)(504=92)(505=92)(506=92)(507=92)(508=92)     
(509=92)(510=92)(511=92)(512=92)(601=95)(602=92)(603=92)(604=95)(701=94)(702=94)(801=87)     
(901=92)(902=92)(1001=92)(1101=92)(1102=92)(1103=92)(1104=92)(1105=92)(1106=92)(1107=92)(1201=92)     
(1202=92)(1203=92)(1204=92)(1205=92)(1206=92)(1207=92)(1208=92)(1209=92)(1210=92)(1211=92)(1212=92)     
(1213=92)(1214=92)(1215=92)(1216=92)(1217=92)(1218=92)(1219=92)(1220=92)(1221=92)(1222=92)(1223=92)     
(1301=92)(1302=92)(1303=92)(1304=92)(1305=92)(1306=92)(1307=92)(1308=92)(1309=92)(1401=92)(1402=92)     
(1403=92)(1501=92)(1601=92)(1602=92)(1603=92)(1604=92)(1605=92)(1606=92)(1607=92)(1701=92)(1702=92)     
(1801=92)(1802=92)(1803=92)(1804=92)(1805=92)(1901=92)(1902=92)(2001=92)(2002=92)(2101=92)(2102=92)     
(2201=92)(2202=92)(2301=92)(2302=92)(2303=92)(2304=92)(2401=93)(2402=93)(2403=93)(2404=93)(2405=93)     
(2406=93)(2407=93)(2408=93)(2409=93)(2501=92)(2502=92)(2503=92)(2601=92)(2602=92)(2701=92)(2801=92)     
(2802=92)(2803=92)(2901=92)(3001=92)(3002=92)(3101=92)(3102=92)(3201=92)(3301=92)(3302=92)(3303=92)     
(3304=92)(3401=92)(3402=92)(3403=92)(3501=92)(3502=92)(3503=92)(3504=92)(3601=92)(3701=92)(3801=92)     
(3901=89)(4001=89)(4002=89)(4003=89)(4004=89)(4101=89)(4102=89)(4103=89)(4104=89)(4105=89)(4106=89)     
(4107=89)(4108=89)(4109=89)(4110=89)(4111=89)(4112=89)(4113=89)(4114=89)(4115=89)(4116=89)(4117=89)     
(4118=89)(4119=89)(4120=89)(4201=89)(4202=89)(4203=89)(4204=89)(4205=89)(4206=89)(4207=89)(4208=89)     
(4209=89)(4301=89)(4302=89)(4303=89)(4304=89)(4305=89)(4401=89)(4402=89)(4403=89)(4501=89)(4502=89)     
(4601=89)(4602=89)(4701=89), gen(icp_seq);
# delimit cr
tempfile code42
save `code42', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==43
# delimit ;
recode COD_ITEM (101/4201=104), gen(icp_seq);
# delimit cr
tempfile code43
save `code43', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==44
# delimit ;
recode COD_ITEM (101/4701=151), gen(icp_seq);
# delimit cr
tempfile code44
save `code44', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==45
# delimit ;
recode COD_ITEM (101/1801=151), gen(icp_seq);
# delimit cr
tempfile code45
save `code45', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==46
# delimit ;
recode COD_ITEM (101/1305=144), gen(icp_seq);
# delimit cr
tempfile code46
save `code46', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==47
# delimit ;
recode COD_ITEM (101/9501=151), gen(icp_seq);
# delimit cr
tempfile code47
save `code47', replace

use "$dirdata/t_despesa_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==49
# delimit ;
recode COD_ITEM (101/9301=135), gen(icp_seq);
# delimit cr
tempfile code49
save `code49', replace

*Vehicles
use "$dirdata/t_despesa_veiculo_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==51
# delimit ;
recode COD_ITEM 
(101=98)(201=123)(202=123)(301=100)(401=99)(501=123)(601=123)(701=123)(801=123)(901=123)(1001=98)     
(1201=123)(1301=123)(1401=123)(1501=123)(1601=98)(1701=101)(1702=101)(1801=123)(1901=123)     
(1902=123)(1903=123)(2001=123)(2002=123)(2003=123)(2101=150)(2201=150)(2301=123), gen(icp_seq);
# delimit cr
tempfile code51
save `code51', replace

use "$dirdata/t_aluguel_estimado_s.dta", clear
egen ori_hid=concat(COD_UF NUM_SEQ NUM_DV COD_DOMC NUM_EXT_RENDA NUM_UC)
gen cons_csh=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO<7
gen cons_gft=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO==7
gen cons_hmp=VAL_DESPESA_CORRIGIDO*FATOR_ANUAL if COD_OBTENCAO>7
keep if NUM_QUADRO==10
# delimit ;
recode COD_ITEM 
(9001=57), gen(icp_seq);
# delimit cr
tempfile rent
save `rent', replace

use `code86', clear
app using `code87'
app using `code88'
app using `code89'
app using `code6'
app using `code7'
app using `code8'
app using `code9'
app using `code10'
app using `code11'
app using `code12'
app using `code13'
app using `code15'
app using `code16'
app using `code17'
app using `code18'
app using `code19'
app using `code22'
app using `code23'
app using `code24'
app using `code25'
app using `code26'
app using `code27'
app using `code28'
app using `code29'
app using `code30'
app using `code31'
app using `code32'
app using `code33'
app using `code34'
app using `code35'
app using `code36'
app using `code37'
app using `code38'
app using `code39'
app using `code40'
app using `code41'
app using `code42'
app using `code43'
app using `code44'
app using `code45'
app using `code46'
app using `code47'
app using `code49'
app using `code51'
app using `rent'
drop if icp_seq==. | icp_seq > 153
sort icp_seq
merge icp_seq using "$dirtech/icp_codes.dta"
drop _merge

drop if icp_seq==. | icp_seq > 153
recode cons_csh cons_hmp cons_gft (.=0)
egen cons_tot=rsum(cons_csh cons_hmp cons_gft)
keep if cons_tot > 0 & cons_tot!=.
egen src_cod=concat(NUM_QUADRO COD_ITEM)
destring src_cod, replace
tostring COD_ITEM, replace
gen _COD_ITEM="_"+COD_ITEM
egen vrs=concat(NUM_QUADRO _COD_ITEM)
gen src_var ="PROD_NUM_QUADRO_GRUPO_PRO + COD_ITEM/" + vrs
keep ori_hid src_cod icp_seq src_var cons_csh cons_hmp cons_gft cons_tot
sort ori_hid
codebook ori_hid
tempfile Non_food
save `Non_food', replace
